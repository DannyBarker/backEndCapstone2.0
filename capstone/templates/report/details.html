{% extends 'shared/base.html' %}

{% block content %}
  <h2>Company Report</h2>

  <h3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${{ total|floatformat:2 }} Donated <font size="2">from {{ payments|length }} card{% if payments|length != 1 %}s{% endif %}.</font></h3>

  <div>
  <section class="report-details-section">
  <div>
    <h3>Amount by Area:</h3>
    {% for key,value in zipcodes.items %}

      <div>{{ key }}: ${{ value|floatformat:2 }}</div>

    {% endfor %}
  </div>
  </section>
  <hr>
  <section class="map-details-section">
  <h3>Map Report:</h3>
    <div id="loadingScreen">
      <div>
      <div class="spinner-grow text-primary" role="status">
        <span class="sr-only">Loading...</span>
      </div>
      <div class="spinner-grow text-primary" role="status">
        <span class="sr-only">Loading...</span>
      </div>
      <div class="spinner-grow text-primary" role="status">
        <span class="sr-only">Loading...</span>
      </div>
      </div>

      <p>Loading Map Report</p>

      <div>
      <div class="spinner-grow text-primary" role="status">
        <span class="sr-only">Loading...</span>
      </div>
      <div class="spinner-grow text-primary" role="status">
        <span class="sr-only">Loading...</span>
      </div>
      <div class="spinner-grow text-primary" role="status">
        <span class="sr-only">Loading...</span>
      </div>
      </div>
    </div>
    <div class="iframe-container">
      <iframe id="mapFrame" title="Map Report" aria-hidden="true" src="{% url 'capstone:map' %}" allowfullscreen></iframe>
    </div>
  </section>
  </div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById("mapFrame").onload = () => {
  document.getElementById("loadingScreen").style.display = "none"
}
</script>
  {% endblock %}